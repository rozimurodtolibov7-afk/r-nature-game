<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>R-Rocket: Space Mission</title>
    <style>
        :root { --fire: #ff6d00; --fuel: #00e5ff; --space: #0b0b1a; }
        body { margin: 0; overflow: hidden; background: var(--space); color: white; font-family: 'Courier New', monospace; touch-action: none; }
        
        canvas { display: block; }

        #hud { position: fixed; top: 20px; width: 100%; display: flex; justify-content: space-around; pointer-events: none; }
        .bar-container { width: 150px; height: 20px; background: #333; border-radius: 10px; border: 2px solid #fff; overflow: hidden; }
        #fuel-fill { width: 100%; height: 100%; background: var(--fuel); transition: width 0.2s; }

        #ui-text { position: fixed; top: 50px; width: 100%; text-align: center; font-size: 20px; font-weight: bold; }

        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; text-align: center; }
        button { padding: 15px 40px; font-size: 20px; border: none; border-radius: 5px; background: var(--fuel); color: #000; cursor: pointer; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

<div id="hud">
    <div>FUEL <div class="bar-container"><div id="fuel-fill"></div></div></div>
    <div>RC: <span id="rc">0</span></div>
</div>
<div id="ui-text">DISTANCE: <span id="dist">0</span>m</div>

<div id="overlay">
    <h1 style="color: var(--fuel); font-size: 40px;">R-ROCKET</h1>
    <p>Collect ‚≠ê for fuel. Avoid ü™® meteorites!<br>Move rocket by dragging your finger.</p>
    <button id="start-btn">LAUNCH MISSION</button>
</div>

<canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const fuelFill = document.getElementById('fuel-fill');
    
    let gameActive = false;
    let fuel = 100;
    let rc = 0;
    let dist = 0;
    let rocketX = 0;
    let items = [];

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSpaceSound(freq, type, dur) {
        let osc = audioCtx.createOscillator();
        let gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        osc.connect(gain); gain.connect(audioCtx.destination);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + dur);
        osc.start(); osc.stop(audioCtx.currentTime + dur);
    }

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        rocketX = canvas.width / 2;
    }
    window.addEventListener('resize', resize);
    resize();

    // Touch movement
    window.addEventListener('touchmove', (e) => {
        if(!gameActive) return;
        rocketX = e.touches[0].clientX;
    });
    window.addEventListener('mousemove', (e) => {
        if(!gameActive) return;
        rocketX = e.clientX;
    });

    function spawnItem() {
        if(!gameActive) return;
        const isMeteor = Math.random() < 0.4;
        items.push({
            x: Math.random() * canvas.width,
            y: -50,
            type: isMeteor ? 'ü™®' : '‚≠ê',
            speed: 3 + Math.random() * 4
        });
        setTimeout(spawnItem, 600 - (dist/50));
    }

    function loop() {
        if(!gameActive) return;

        ctx.fillStyle = '#0b0b1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Stars Background
        ctx.fillStyle = '#fff';
        for(let i=0; i<10; i++) ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 2, 2);

        // Rocket
        ctx.font = '50px Arial';
        ctx.fillText('üöÄ', rocketX - 25, canvas.height - 80);

        // Items logic
        items.forEach((item, i) => {
            item.y += item.speed;
            ctx.font = '30px Arial';
            ctx.fillText(item.type, item.x - 15, item.y);

            // Collision
            let dx = item.x - rocketX;
            let dy = item.y - (canvas.height - 80);
            if(Math.hypot(dx, dy) < 40) {
                if(item.type === '‚≠ê') {
                    fuel = Math.min(100, fuel + 15);
                    rc += 10;
                    playSpaceSound(600, 'sine', 0.1);
                } else {
                    fuel -= 25;
                    playSpaceSound(100, 'sawtooth', 0.3);
                }
                items.splice(i, 1);
            }

            if(item.y > canvas.height) items.splice(i, 1);
        });

        // Stats update
        fuel -= 0.15; // Natural consumption
        dist += 1;
        fuelFill.style.width = fuel + '%';
        document.getElementById('rc').innerText = rc;
        document.getElementById('dist').innerText = Math.floor(dist/10);

        if(fuel <= 0) gameOver();

        requestAnimationFrame(loop);
    }

    function gameOver() {
        gameActive = false;
        playSpaceSound(50, 'square', 1);
        alert(`MISSION ABORTED! \nDistance: ${Math.floor(dist/10)}m \nRC Collected: ${rc}`);
        location.reload();
    }

    document.getElementById('start-btn').onclick = () => {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        document.getElementById('overlay').style.display = 'none';
        gameActive = true;
        spawnItem();
        loop();
        // Background Space Hum
        setInterval(() => { if(gameActive) playSpaceSound(80, 'sine', 2); }, 2000);
    };
</script>
</body>
</html>