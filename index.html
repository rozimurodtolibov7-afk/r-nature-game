<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>R-Nature: International</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
        body { font-family: 'Comic Sans MS', cursive, sans-serif; overflow: hidden; background: #2ecc71; color: #2c3e50; }

        /* TIL TANLASH EKRANI */
        #lang-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 3000; display: flex; flex-direction: column; align-items: center; padding: 20px;
        }
        .lang-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; margin-top: 20px; }
        .lang-btn { background: #f1f1f1; border: 3px solid #eee; padding: 15px; border-radius: 15px; text-align: center; font-weight: bold; cursor: pointer; }
        .lang-btn:active { background: #e0e0e0; }

        /* ASOSIY MENU */
        #menu-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://wallpapercave.com/wp/wp3105346.jpg');
            background-size: cover; background-position: center;
            display: none; flex-direction: column; align-items: center; justify-content: space-between;
            padding: 40px 20px; z-index: 1000;
        }

        #game-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; }
        #nature-world { width: 100%; height: 100%; position: absolute; background: url('https://img.freepik.com/free-vector/landscape-park-with-green-grass-trees_107791-2053.jpg'); background-size: cover; }

        .title { color: white; font-size: 45px; font-weight: 900; text-shadow: 4px 4px 0px #27ae60; }
        .pill { background: white; padding: 8px 15px; border-radius: 20px; font-weight: bold; border: 3px solid #f1c40f; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .play-btn { width: 130px; height: 130px; background: #f1c40f; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; border: 8px solid white; box-shadow: 0 8px 0px #d4ac0d; }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; width: 100%; }
        .grid-btn { background: #3498db; border: 3px solid white; color: white; padding: 15px 5px; border-radius: 15px; text-align: center; font-weight: bold; box-shadow: 0 5px 0px #2980b9; }

        #modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-box { background: white; width: 90%; border-radius: 25px; padding: 20px; max-height: 75vh; overflow-y: auto; border: 5px solid #3498db; }
        .shop-row { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-bottom: 2px dashed #eee; }
        .buy-btn { background: #2ecc71; color: white; border: none; padding: 8px 12px; border-radius: 10px; font-weight: bold; box-shadow: 0 3px 0 #27ae60; }
        .plant { position: absolute; font-size: 50px; transform: translate(-50%, -50%); pointer-events: none; z-index: 5; animation: grow 0.4s ease-out; }
    </style>
</head>
<body>

    <div id="lang-screen">
        <h2 style="margin-top:20px;">Choose Language</h2>
        <div class="lang-grid" id="lang-list"></div>
    </div>

    <div id="menu-screen">
        <div class="title">R-NATURE</div>
        <div style="display:flex; gap:10px;">
            <div class="pill">üí∞ <span id="m-bal">0.00</span></div>
            <div class="pill" style="border-color:#3498db">‚≠ê Lvl <span id="m-lvl">1</span></div>
        </div>
        <div class="play-btn" id="btn-play">PLAY</div>
        <div class="menu-grid">
            <div class="grid-btn" id="btn-shop">üõí</div>
            <div class="grid-btn" id="btn-rank">üèÜ</div>
            <div class="grid-btn" id="btn-friends">üë•</div>
        </div>
    </div>

    <div id="game-screen">
        <div style="position:absolute; top:15px; left:15px; z-index:10; display:flex; gap:10px;">
            <div class="pill" id="btn-back">üè†</div>
            <div class="pill">üí∞ <span id="g-bal">0.00</span></div>
            <div class="pill" style="border-color:#3498db">‚≠ê <span id="g-xp">0</span> XP</div>
        </div>
        <div id="nature-world"></div>
        <div style="position:absolute; bottom:30px; right:20px; display:flex; flex-direction:column; gap:15px; z-index:10;">
            <button class="play-btn" style="width:65px; height:65px; font-size:30px;" id="btn-inv">üéí</button>
            <button class="play-btn" style="width:65px; height:65px; font-size:30px; background:#f1c40f;" id="btn-game-shop">üõí</button>
        </div>
    </div>

    <div id="modal-overlay">
        <div class="modal-box">
            <h2 id="modal-title" style="text-align:center; margin-bottom:15px;"></h2>
            <div id="modal-list"></div>
            <button id="modal-close" style="width:100%; margin-top:15px; padding:12px; background:#e74c3c; color:white; border:none; border-radius:15px; font-weight:bold;">Close</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const languages = {
            'uz': { play: "O'YIN", shop: "Do'kon", rank: "Reyting", invite: "Taklif", back: "Menyu", inv: "Sandiq", close: "Yopish", low: "Mablag' yetarli emas!", lvlup: "Daraja oshdi!" },
            'ru': { play: "–ò–ì–†–ê–¢–¨", shop: "–ú–∞–≥–∞–∑–∏–Ω", rank: "–†–µ–π—Ç–∏–Ω–≥", invite: "–î—Ä—É–∑—å—è", back: "–ú–µ–Ω—é", inv: "–†—é–∫–∑–∞–∫", close: "–ó–∞–∫—Ä—ã—Ç—å", low: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!", lvlup: "–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å!" },
            'en': { play: "PLAY", shop: "Shop", rank: "Rank", invite: "Invite", back: "Menu", inv: "Bag", close: "Close", low: "Not enough money!", lvlup: "Level Up!" },
            'tr': { play: "OYNAT", shop: "Maƒüaza", rank: "Sƒ±ralama", invite: "Davet", back: "Men√º", inv: "√áanta", close: "Kapat", low: "Yetersiz bakiye!", lvlup: "Seviye Atladƒ±n!" },
            'de': { play: "SPIELEN", shop: "Laden", rank: "Rang", invite: "Einladen", back: "Men√º", inv: "Tasche", close: "Schlie√üen", low: "Nicht genug Geld!", lvlup: "Level Aufstieg!" },
            'fr': { play: "JOUER", shop: "Boutique", rank: "Rang", invite: "Inviter", back: "Menu", inv: "Sac", close: "Fermer", low: "Pas assez d'argent!", lvlup: "Niveau Sup√©rieur!" },
            'es': { play: "JUGAR", shop: "Tienda", rank: "Rango", invite: "Invitar", back: "Men√∫", inv: "Bolsa", close: "Cerrar", low: "¬°Dinero insuficiente!", lvlup: "¬°Nivel completado!" },
            'ar': { play: "ŸÑÿπÿ®", shop: "ŸÖÿ™ÿ¨ÿ±", rank: "ÿ™ÿ±ÿ™Ÿäÿ®", invite: "ÿØÿπŸàÿ©", back: "ŸÇÿßÿ¶ŸÖÿ©", inv: "ÿ≠ŸÇŸäÿ®ÿ©", close: "ÿ•ÿ∫ŸÑÿßŸÇ", low: "ÿ±ÿµŸäÿØ ÿ∫Ÿäÿ± ŸÉÿßŸÅ!", lvlup: "ÿßÿ±ÿ™ŸÅÿßÿπ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ!" },
            'hi': { play: "‡§ñ‡•á‡§≤‡•á‡§Ç", shop: "‡§¶‡•Å‡§ï‡§æ‡§®", rank: "‡§∞‡•à‡§Ç‡§ï", invite: "‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§", back: "‡§Æ‡•á‡§®‡•Ç", inv: "‡§ù‡•ã‡§≤‡§æ", close: "‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç", low: "‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§™‡•à‡§∏‡•á ‡§®‡§π‡•Ä‡§Ç!", lvlup: "‡§∏‡•ç‡§§‡§∞ ‡§ä‡§™‡§∞!" },
            'zh': { play: "Áé©", shop: "ÂïÜÂ∫ó", rank: "ÊéíË°å", invite: "ÈÇÄËØ∑", back: "ËèúÂçï", inv: "ËÉåÂåÖ", close: "ÂÖ≥Èó≠", low: "‰ΩôÈ¢ù‰∏çË∂≥!", lvlup: "Á≠âÁ∫ßÊèêÂçá!" }
        };

        const langFlags = { 'uz': 'üá∫üáø O\'zbek', 'ru': 'üá∑üá∫ –†—É—Å—Å–∫–∏–π', 'en': 'üá∫üá∏ English', 'tr': 'üáπüá∑ T√ºrk√ße', 'de': 'üá©üá™ Deutsch', 'fr': 'üá´üá∑ Fran√ßais', 'es': 'üá™üá∏ Espa√±ol', 'ar': 'üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', 'hi': 'üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', 'zh': 'üá®üá≥ ‰∏≠Êñá' };

        let data = JSON.parse(localStorage.getItem('rn_v11_save')) || {
            bal: 10.00, xp: 0, lvl: 1, inv: { "Atirgul": 1 }, planted: [], lang: null
        };

        function initLang() {
            const list = document.getElementById('lang-list');
            for(let code in langFlags) {
                const b = document.createElement('div');
                b.className = 'lang-btn';
                b.innerText = langFlags[code];
                b.onclick = () => { data.lang = code; save(); startMenu(); };
                list.appendChild(b);
            }
            if(data.lang) startMenu();
        }

        function startMenu() {
            document.getElementById('lang-screen').style.display = 'none';
            document.getElementById('menu-screen').style.display = 'flex';
            const l = languages[data.lang];
            document.getElementById('btn-play').innerText = l.play;
            document.getElementById('btn-shop').innerText = "üõí " + l.shop;
            document.getElementById('btn-rank').innerText = "üèÜ " + l.rank;
            document.getElementById('btn-friends').innerText = "üë• " + l.invite;
            document.getElementById('modal-close').innerText = l.close;
            document.getElementById('btn-back').innerText = "üè† " + l.back;
            updateUI();
        }

        const items = [
            { n: "Atirgul", p: 10, i: "üåπ", inc: 0.1, xp: 5 },
            { n: "Qulupnay", p: 40, i: "üçì", inc: 0.5, xp: 15 },
            { n: "Gilos", p: 80, i: "üçí", inc: 1.2, xp: 30 },
            { n: "Kaktus", p: 500, i: "üåµ", inc: 8.0, xp: 150 }
        ];

        function setupBtn(id, action) { document.getElementById(id).onclick = (e) => { e.preventDefault(); action(); }; }

        setupBtn('btn-play', () => { document.getElementById('menu-screen').style.display = 'none'; document.getElementById('game-screen').style.display = 'block'; renderPlanted(); });
        setupBtn('btn-back', () => { document.getElementById('game-screen').style.display = 'none'; document.getElementById('menu-screen').style.display = 'flex'; });
        setupBtn('btn-shop', () => openShop());
        setupBtn('btn-game-shop', () => openShop());
        setupBtn('btn-inv', () => openInv());
        setupBtn('modal-close', () => document.getElementById('modal-overlay').style.display = 'none');

        function openShop() {
            const l = languages[data.lang];
            document.getElementById('modal-title').innerText = l.shop;
            const list = document.getElementById('modal-list'); list.innerHTML = '';
            items.forEach(item => {
                const row = document.createElement('div');
                row.className = 'shop-row';
                row.innerHTML = `<span>${item.i} ${item.n}</span> <button class='buy-btn'>${item.p} RC</button>`;
                row.querySelector('button').onclick = () => {
                    if(data.bal >= item.p) {
                        data.bal -= item.p; data.inv[item.n] = (data.inv[item.n] || 0) + 1;
                        save(); updateUI(); openShop(); tg.HapticFeedback.notificationOccurred('success');
                    } else { tg.showAlert(l.low); }
                };
                list.appendChild(row);
            });
            document.getElementById('modal-overlay').style.display = 'flex';
        }

        function openInv() {
            document.getElementById('modal-title').innerText = languages[data.lang].inv;
            const list = document.getElementById('modal-list'); list.innerHTML = '';
            for(let n in data.inv) {
                if(data.inv[n] > 0) {
                    const icon = items.find(i => i.n === n).i;
                    const row = document.createElement('div');
                    row.className = 'shop-row';
                    row.innerHTML = `<span>${icon} ${n} (${data.inv[n]})</span> <button class='buy-btn' style='background:#3498db'>PLAY</button>`;
                    row.querySelector('button').onclick = () => { selected = n; document.getElementById('modal-overlay').style.display = 'none'; };
                    list.appendChild(row);
                }
            }
            document.getElementById('modal-overlay').style.display = 'flex';
        }

        document.getElementById('nature-world').onclick = (e) => {
            if(!selected || data.inv[selected] <= 0) return;
            const item = items.find(i => i.n === selected);
            const p = { x: e.clientX, y: e.clientY, i: item.i, n: item.n };
            data.planted.push(p); data.inv[selected]--; data.xp += item.xp;
            if(data.xp >= data.lvl * 100) { data.lvl++; data.bal += 50; tg.showAlert(languages[data.lang].lvlup); }
            draw(p); save(); updateUI(); tg.HapticFeedback.impactOccurred('medium');
        };

        function draw(p) {
            const el = document.createElement('div'); el.className = 'plant';
            el.style.left = p.x + 'px'; el.style.top = p.y + 'px'; el.innerText = p.i;
            document.getElementById('nature-world').appendChild(el);
        }

        function renderPlanted() { document.getElementById('nature-world').innerHTML = ''; data.planted.forEach(draw); }
        function updateUI() {
            document.getElementById('m-bal').innerText = data.bal.toFixed(2);
            document.getElementById('g-bal').innerText = data.bal.toFixed(2);
            document.getElementById('m-lvl').innerText = data.lvl;
            document.getElementById('g-xp').innerText = data.xp;
        }
        function save() { localStorage.setItem('rn_v11_save', JSON.stringify(data)); }
        
        setInterval(() => {
            let inc = 0;
            data.planted.forEach(p => { const it = items.find(i => i.n === p.n); if(it) inc += it.inc; });
            if(inc > 0) { data.bal += inc; updateUI(); save(); }
        }, 10000);

        initLang();
    </script>
</body>
</html>