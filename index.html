<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>R-Nature: Eko-Sayohat</title>
    <style>
        :root { --grass: #2ecc71; --dirt: #795548; --sky: #87CEEB; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; overflow: hidden; font-family: sans-serif; background: var(--sky); }

        /* Dunyo va Harakat */
        #game-world { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
        #ground { position: absolute; bottom: 0; width: 200%; height: 100px; background: var(--dirt); border-top: 10px solid var(--grass); display: flex; animation: moveGround 5s linear infinite; }
        @keyframes moveGround { from { transform: translateX(0); } to { transform: translateX(-50%); } }

        /* Qahramon */
        #player { position: absolute; bottom: 100px; left: 50px; font-size: 50px; z-index: 10; transition: 0.3s; }

        /* O'simliklar */
        .plant { position: absolute; bottom: 100px; font-size: 40px; cursor: pointer; transition: 0.5s; z-index: 5; }
        .dry { filter: grayscale(100%) sepia(50%); transform: scale(0.8); }
        .bloomed { filter: grayscale(0%); transform: scale(1.2); }

        /* UI */
        #ui { position: fixed; top: 20px; width: 100%; text-align: center; z-index: 100; pointer-events: none; }
        .score-box { background: rgba(0,0,0,0.5); color: white; padding: 10px 20px; border-radius: 20px; font-size: 20px; font-weight: bold; border: 2px solid #fff; }
        
        #start-screen { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; color: white; }
        button { padding: 15px 40px; font-size: 20px; border-radius: 30px; border: none; background: var(--grass); color: white; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div id="start-screen">
    <h1>R-Nature</h1>
    <p>O'simliklarni sug'orib dunyoni qutqaring!</p>
    <button onclick="startGame()">O'yinni boshlash üåø</button>
</div>

<div id="ui">
    <span class="score-box">üí∞ <span id="rc-score">0</span> RC</span>
</div>

<div id="game-world">
    <div id="player">üèÉ</div>
    <div id="ground"></div>
</div>

<audio id="nature-music" loop src="https://www.chosic.com/wp-content/uploads/2021/04/Fairy-Tale-Tree-of-Life.mp3"></audio>

<script>
    let rc = 0;
    let gameActive = false;
    const player = document.getElementById('player');
    const world = document.getElementById('game-world');
    const music = document.getElementById('nature-music');

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        gameActive = true;
        music.play();
        spawnPlant();
    }

    function spawnPlant() {
        if(!gameActive) return;
        
        const plant = document.createElement('div');
        plant.className = 'plant dry';
        plant.innerHTML = 'üåµ'; // Qurigan holati
        plant.style.right = '-100px';
        world.appendChild(plant);

        let pos = -100;
        const moveInterval = setInterval(() => {
            if(!gameActive) { clearInterval(moveInterval); return; }
            pos += 5;
            plant.style.right = pos + 'px';

            // Agar o'simlik sug'orilmay o'tib ketsa
            if(pos > window.innerWidth) {
                if(plant.classList.contains('dry')) {
                    gameOver();
                }
                plant.remove();
                clearInterval(moveInterval);
            }
        }, 20);

        plant.onclick = () => {
            if(plant.classList.contains('dry')) {
                plant.classList.remove('dry');
                plant.classList.add('bloomed');
                plant.innerHTML = 'üå∏'; // Sug'orilgan holati
                rc += 10;
                document.getElementById('rc-score').innerText = rc;
                playWaterSound();
            }
        };

        setTimeout(spawnPlant, Math.random() * 2000 + 1500);
    }

    function playWaterSound() {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain); gain.connect(ctx.destination);
        osc.frequency.value = 1000;
        osc.start();
        gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.1);
        osc.stop(ctx.currentTime + 0.1);
    }

    function gameOver() {
        gameActive = false;
        music.pause();
        alert("O'simlik sug'orilmadi! Yo'l qurib qoldi. Jami RC: " + rc);
        location.reload();
    }
</script>
</body>
</html>